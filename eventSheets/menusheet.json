{
	"name": "MenuSheet",
	"events": [
		{
			"eventType": "variable",
			"name": "LoadOrder",
			"type": "number",
			"initialValue": "0",
			"comment": "",
			"isStatic": false,
			"isConstant": false,
			"sid": 651870526317215
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "on-start-of-layout",
					"objectClass": "System",
					"sid": 607858622928039
				}
			],
			"actions": [
				{
					"callFunction": "EnableScrolling",
					"sid": 834823696598779,
					"parameters": [
						true,
						true,
						"640",
						"360",
						"640",
						"0",
						true
					]
				},
				{
					"id": "check-item-exists",
					"objectClass": "LocalStorage",
					"sid": 867063103208534,
					"parameters": {
						"key": "\"map_amount\""
					}
				},
				{
					"id": "check-item-exists",
					"objectClass": "LocalStorage",
					"sid": 171596294081997,
					"parameters": {
						"key": "\"map_names\""
					}
				},
				{
					"id": "check-item-exists",
					"objectClass": "LocalStorage",
					"sid": 600330960102040,
					"parameters": {
						"key": "\"map_dates\""
					}
				},
				{
					"id": "alert",
					"objectClass": "Browser",
					"sid": 677213767086773,
					"parameters": {
						"message": "Date.ToLocaleString(Date.Now)"
					}
				},
				{
					"id": "request-project-file",
					"objectClass": "AJAX",
					"sid": 590401108217625,
					"parameters": {
						"tag": "\"DefLvl\"",
						"file": "DefLvl.json"
					}
				}
			],
			"sid": 851196216785112
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "on-item-missing",
					"objectClass": "LocalStorage",
					"sid": 797560155982916,
					"parameters": {
						"key": "\"map_amount\""
					}
				},
				{
					"id": "on-item-missing",
					"objectClass": "LocalStorage",
					"sid": 943581911453606,
					"parameters": {
						"key": "\"map_names\""
					}
				},
				{
					"id": "on-item-missing",
					"objectClass": "LocalStorage",
					"sid": 128780758647306,
					"parameters": {
						"key": "\"map_dates\""
					}
				}
			],
			"actions": [
				{
					"id": "set-item",
					"objectClass": "LocalStorage",
					"sid": 708824859584640,
					"parameters": {
						"key": "\"map_amount\"",
						"value": "0"
					}
				},
				{
					"id": "set-item",
					"objectClass": "LocalStorage",
					"sid": 390931726413918,
					"parameters": {
						"key": "\"map_dates\"",
						"value": "map_dates.AsJSON"
					}
				},
				{
					"id": "set-item",
					"objectClass": "LocalStorage",
					"sid": 884159047396406,
					"parameters": {
						"key": "\"map_names\"",
						"value": "map_names.AsJSON"
					}
				}
			],
			"sid": 778609804904198,
			"isOrBlock": true
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "on-item-exists",
					"objectClass": "LocalStorage",
					"sid": 535437780299065,
					"parameters": {
						"key": "\"map_names\""
					}
				}
			],
			"actions": [
				{
					"id": "get-item",
					"objectClass": "LocalStorage",
					"sid": 851787852559634,
					"parameters": {
						"key": "\"map_names\""
					}
				}
			],
			"sid": 343010230532716
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "on-item-exists",
					"objectClass": "LocalStorage",
					"sid": 721736131318511,
					"parameters": {
						"key": "\"map_dates\""
					}
				}
			],
			"actions": [
				{
					"id": "get-item",
					"objectClass": "LocalStorage",
					"sid": 393240028535202,
					"parameters": {
						"key": "\"map_dates\""
					}
				}
			],
			"sid": 148391601154019
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "on-item-get",
					"objectClass": "LocalStorage",
					"sid": 514127697135879,
					"parameters": {
						"key": "\"map_names\""
					}
				}
			],
			"actions": [
				{
					"id": "load",
					"objectClass": "map_names",
					"sid": 461595482220219,
					"parameters": {
						"json": "LocalStorage.ItemValue"
					}
				},
				{
					"id": "add-to-eventvar",
					"objectClass": "System",
					"sid": 849405169843153,
					"parameters": {
						"variable": "LoadOrder",
						"value": "1"
					}
				}
			],
			"sid": 342484817433942,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-eventvar",
							"objectClass": "System",
							"sid": 236786733716106,
							"parameters": {
								"variable": "LoadOrder",
								"comparison": 0,
								"value": "2"
							}
						}
					],
					"actions": [
						{
							"id": "get-item",
							"objectClass": "LocalStorage",
							"sid": 276677530453104,
							"disabled": true,
							"parameters": {
								"key": "\"map_amount\""
							}
						},
						{
							"callFunction": "Display_maps",
							"sid": 316124677219957
						}
					],
					"sid": 458879678503399
				}
			]
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "on-item-get",
					"objectClass": "LocalStorage",
					"sid": 283473647259599,
					"parameters": {
						"key": "\"map_dates\""
					}
				}
			],
			"actions": [
				{
					"id": "load",
					"objectClass": "map_dates",
					"sid": 226230698701297,
					"parameters": {
						"json": "LocalStorage.ItemValue"
					}
				},
				{
					"id": "add-to-eventvar",
					"objectClass": "System",
					"sid": 922603879732422,
					"parameters": {
						"variable": "LoadOrder",
						"value": "1"
					}
				}
			],
			"sid": 795303044461270,
			"children": [
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-eventvar",
							"objectClass": "System",
							"sid": 479842611884225,
							"parameters": {
								"variable": "LoadOrder",
								"comparison": 0,
								"value": "2"
							}
						}
					],
					"actions": [
						{
							"id": "get-item",
							"objectClass": "LocalStorage",
							"sid": 206218674061234,
							"disabled": true,
							"parameters": {
								"key": "\"map_amount\""
							}
						},
						{
							"callFunction": "Display_maps",
							"sid": 669772612040840
						}
					],
					"sid": 627857660631249
				}
			]
		},
		{
			"functionName": "Display_maps",
			"functionDescription": "",
			"functionCategory": "GUI",
			"functionReturnType": "none",
			"functionIsAsync": false,
			"functionParameters": [],
			"eventType": "function-block",
			"conditions": [],
			"actions": [],
			"sid": 822136181988827,
			"children": [
				{
					"eventType": "variable",
					"name": "total",
					"type": "number",
					"initialValue": "0",
					"comment": "",
					"isStatic": false,
					"isConstant": false,
					"sid": 735656186767963
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "for-each-key",
							"objectClass": "map_names",
							"sid": 300452074314283
						}
					],
					"actions": [
						{
							"id": "spawn-one-object",
							"objectClass": "ValeryppoffLayouter",
							"sid": 459968522409528,
							"parameters": {
								"object": "map_back",
								"index": "total",
								"match-size": "match",
								"match-angle": "match",
								"index-num": "0",
								"scale-wid-num": "-1",
								"scale-hei-num": "-1"
							}
						},
						{
							"id": "add-to-eventvar",
							"objectClass": "System",
							"sid": 654298203813323,
							"parameters": {
								"variable": "total",
								"value": "1"
							}
						},
						{
							"id": "set-instvar-value",
							"objectClass": "map_back",
							"sid": 787187796510899,
							"parameters": {
								"instance-variable": "async_val",
								"value": "map_names.CurrentKey"
							}
						},
						{
							"callFunction": "Create_map_entry",
							"sid": 458338698587939,
							"parameters": [
								"map_back.UID"
							]
						}
					],
					"sid": 146409655143517
				},
				{
					"eventType": "comment",
					"text": "Display add new message"
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-eventvar",
							"objectClass": "System",
							"sid": 212375626916597,
							"parameters": {
								"variable": "total",
								"comparison": 2,
								"value": "25"
							}
						}
					],
					"actions": [
						{
							"id": "spawn-one-object",
							"objectClass": "ValeryppoffLayouter",
							"sid": 539693875171269,
							"parameters": {
								"object": "map_back",
								"index": "total",
								"match-size": "match",
								"match-angle": "match",
								"index-num": "0",
								"scale-wid-num": "-1",
								"scale-hei-num": "-1"
							}
						},
						{
							"id": "wait",
							"objectClass": "System",
							"sid": 769258579480217,
							"parameters": {
								"seconds": "dt"
							}
						},
						{
							"id": "create-object",
							"objectClass": "System",
							"sid": 459895355920727,
							"parameters": {
								"object-to-create": "map_name_txt",
								"layer": "0",
								"x": "map_back.X + 0",
								"y": "map_back.Y + 0",
								"create-hierarchy": false,
								"template-name": "\"\""
							}
						},
						{
							"id": "set-text",
							"objectClass": "map_name_txt",
							"sid": 962239269616702,
							"parameters": {
								"text": "\"Создать новую карту\""
							}
						},
						{
							"id": "create-object",
							"objectClass": "System",
							"sid": 774770390214592,
							"parameters": {
								"object-to-create": "create_map",
								"layer": "0",
								"x": "map_back.X + 640",
								"y": "map_back.Y + 144",
								"create-hierarchy": false,
								"template-name": "\"\""
							}
						},
						{
							"id": "create-object",
							"objectClass": "System",
							"sid": 750016570541680,
							"parameters": {
								"object-to-create": "map_new_name",
								"layer": "0",
								"x": "map_back.X + 32",
								"y": "map_back.Y + 144",
								"create-hierarchy": false,
								"template-name": "\"\""
							}
						}
					],
					"sid": 557201390966681
				}
			]
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "on-item-get",
					"objectClass": "LocalStorage",
					"sid": 230120634783181,
					"parameters": {
						"key": "\"map_amount\""
					}
				}
			],
			"actions": [
				{
					"callFunction": "Display_maps",
					"sid": 720372882624109
				}
			],
			"sid": 695192688701644
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "on-all-sets-complete",
					"objectClass": "LocalStorage",
					"sid": 723427444983886
				}
			],
			"actions": [
				{
					"id": "get-item",
					"objectClass": "LocalStorage",
					"sid": 105519231448562,
					"parameters": {
						"key": "\"map_names\""
					}
				},
				{
					"id": "get-item",
					"objectClass": "LocalStorage",
					"sid": 464816329503007,
					"parameters": {
						"key": "\"map_dates\""
					}
				},
				{
					"id": "get-item",
					"objectClass": "LocalStorage",
					"sid": 586096608489085,
					"parameters": {
						"key": "\"map_amount\""
					}
				}
			],
			"sid": 348428619879021
		},
		{
			"eventType": "comment",
			"text": "Fill in the data when loaded"
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "on-any-item-get",
					"objectClass": "LocalStorage",
					"sid": 593242652878367
				},
				{
					"id": "pick-by-comparison",
					"objectClass": "System",
					"sid": 664920169390284,
					"parameters": {
						"object": "map_back",
						"expression": "map_back.async_val",
						"comparison": 0,
						"value": "LocalStorage.Key"
					}
				}
			],
			"actions": [],
			"sid": 330368729735944
		},
		{
			"functionName": "Create_map_entry",
			"functionDescription": "",
			"functionCategory": "GUI",
			"functionReturnType": "none",
			"functionIsAsync": false,
			"functionParameters": [
				{
					"name": "map_back_UID",
					"type": "number",
					"initialValue": "0",
					"comment": "",
					"sid": 723506646693785
				}
			],
			"eventType": "function-block",
			"conditions": [
				{
					"id": "pick-by-unique-id",
					"objectClass": "map_back",
					"sid": 913594647953736,
					"parameters": {
						"unique-id": "map_back_UID"
					}
				}
			],
			"actions": [
				{
					"id": "create-object",
					"objectClass": "System",
					"sid": 785821243846638,
					"parameters": {
						"object-to-create": "map_name_txt",
						"layer": "0",
						"x": "map_back.X + 0",
						"y": "map_back.Y + 0",
						"create-hierarchy": false,
						"template-name": "\"\""
					}
				},
				{
					"id": "set-text",
					"objectClass": "map_name_txt",
					"sid": 275098923534727,
					"parameters": {
						"text": "map_names.Get(map_back.async_val)"
					}
				},
				{
					"id": "create-object",
					"objectClass": "System",
					"sid": 900072829959203,
					"parameters": {
						"object-to-create": "map_date_txt",
						"layer": "0",
						"x": "map_back.X + 0",
						"y": "map_back.Y + 128",
						"create-hierarchy": false,
						"template-name": "\"\""
					}
				},
				{
					"id": "set-text",
					"objectClass": "map_date_txt",
					"sid": 175105938324312,
					"parameters": {
						"text": "Date.ToLocaleString(map_dates.Get(map_back.async_val))"
					}
				},
				{
					"id": "create-object",
					"objectClass": "System",
					"sid": 863002154341026,
					"parameters": {
						"object-to-create": "delete_map",
						"layer": "0",
						"x": "map_back.X + 640",
						"y": "map_back.Y + 160",
						"create-hierarchy": false,
						"template-name": "\"\""
					}
				},
				{
					"id": "create-object",
					"objectClass": "System",
					"sid": 611907568719710,
					"parameters": {
						"object-to-create": "rename_map",
						"layer": "0",
						"x": "map_back.X + 640",
						"y": "map_back.Y + 112",
						"create-hierarchy": false,
						"template-name": "\"\""
					}
				},
				{
					"id": "create-object",
					"objectClass": "System",
					"sid": 203405247675971,
					"parameters": {
						"object-to-create": "download_map",
						"layer": "0",
						"x": "map_back.X + 640",
						"y": "map_back.Y + 64",
						"create-hierarchy": false,
						"template-name": "\"\""
					}
				},
				{
					"id": "create-object",
					"objectClass": "System",
					"sid": 621394536754260,
					"parameters": {
						"object-to-create": "load_map",
						"layer": "0",
						"x": "map_back.X + 640",
						"y": "map_back.Y + 16",
						"create-hierarchy": false,
						"template-name": "\"\""
					}
				}
			],
			"sid": 744357005344046
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "on-clicked",
					"objectClass": "create_map",
					"sid": 402777763422433
				},
				{
					"id": "compare-text",
					"objectClass": "map_new_name",
					"sid": 445778614538553,
					"parameters": {
						"text": "\"\"",
						"case": "case-insensitive"
					},
					"isInverted": true
				},
				{
					"id": "pick-overlapping-point",
					"objectClass": "System",
					"sid": 145735477353247,
					"parameters": {
						"object": "map_back",
						"x": "create_map.X",
						"y": "create_map.Y"
					}
				}
			],
			"actions": [],
			"sid": 401975410027393,
			"children": [
				{
					"eventType": "variable",
					"name": "id",
					"type": "number",
					"initialValue": "0",
					"comment": "",
					"isStatic": false,
					"isConstant": false,
					"sid": 401674265915843
				},
				{
					"eventType": "block",
					"conditions": [],
					"actions": [
						{
							"id": "set-eventvar-value",
							"objectClass": "System",
							"sid": 675618351268880,
							"parameters": {
								"variable": "id",
								"value": "int(random(0, 999999999))"
							}
						},
						{
							"id": "add-key",
							"objectClass": "map_names",
							"sid": 347478769345126,
							"parameters": {
								"key": "\"map_\"&id",
								"value": "map_new_name.Text"
							}
						},
						{
							"id": "add-key",
							"objectClass": "map_dates",
							"sid": 773198440970022,
							"parameters": {
								"key": "\"map_\"&id",
								"value": "Date.Now"
							}
						},
						{
							"id": "load",
							"objectClass": "ThisLvl",
							"sid": 256735093136010,
							"parameters": {
								"json": "DefLvl.AsJSON"
							}
						},
						{
							"id": "set-item",
							"objectClass": "LocalStorage",
							"sid": 184272142594902,
							"parameters": {
								"key": "\"map_\"&id",
								"value": "ThisLvl.AsJSON"
							}
						},
						{
							"id": "go-to-layout",
							"objectClass": "System",
							"sid": 492245848193060,
							"parameters": {
								"layout": "Editor"
							}
						}
					],
					"sid": 579470034681684
				}
			]
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "on-completed",
					"objectClass": "AJAX",
					"sid": 752649142953056,
					"parameters": {
						"tag": "\"DefLvl\""
					}
				}
			],
			"actions": [
				{
					"id": "load",
					"objectClass": "DefLvl",
					"sid": 189363940778337,
					"parameters": {
						"json": "AJAX.LastData"
					}
				}
			],
			"sid": 438502582413575
		}
	],
	"sid": 662222665187186
}